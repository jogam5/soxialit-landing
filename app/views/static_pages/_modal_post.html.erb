<div style="top:50%; left:50%; width:595px" class="modal-soxialit">
	<div style="max-height: 430px" class="modal-body">
    <button type="button" class="close-button" data-dismiss="modal" aria-hidden="true">X</button>
		<div class="span7">
			<% if user_signed_in? %>
			  <p style="font-weight:lighter; color:#777; font-size:1.5em; font-family:acta-display;">Comparte una historia</p>
        <br>
			  <%= form_for(@micropost, 
			              {:id => "modal", :rel => "tab", :remote => true, 'data-controls-modal' =>  "modal-window", 'data-backdrop' => true, 'data-keyboard' => true } ) do |f| %>
			  	  <%= render 'shared/error_messages', object: f.object %>
			    <div class="field">
            <span id="label_url" style="font-weight:lighter; color:#777; font-size:0.9em; font-family:acta-display;float:left; margin-right: 5%">Link de tu post: </span>
             <span id="label_picture" style="display:none; float:left; margin-right: 5%; font-weight:lighter; color:#777; font-size:0.9em; font-family:acta-display;">Archivo de tu imagen: </span>
			      <%= f.text_area :url, :rows => "1", :class => "span4", :id => "status" %>
            <%= f.file_field :picture, :id => "file_for_picture", style: "display:none" %>
			    </div>
          <p id="selection_file" style="margin-left:22%; font-size: 0.9em"><span id="select_file" style="cursor:pointer; color: rgb(0, 165, 240);">Elige una imagen</span>. JPEG, PNG ó GIF. Tamaño Max. 2MB</p>
          <p id="selection_url" style="margin-left:22%; font-size: 0.9em; display:none"><span id="select_file" style="cursor:pointer; color: rgb(0, 165, 240);">Utiliza un link</span>. Utiliza un link para compartir</p>
			      <%= f.hidden_field :url %>
			      <%= f.hidden_field :provider %>
            <p style="display:none" id ="post_title"> 
			       <span id="label_url" style="font-weight:lighter; color:#777; font-size:0.9em; font-family:acta-display;float:left; margin-right: 5%">Elige un título : </span>
            <%= f.text_field :title %>
            </p>
			      <%= f.hidden_field :description %>
			      <%= f.hidden_field :thumbnail %>
			      <%= f.hidden_field :status, value: true %>
             <span id="micropost-tags" style="font-weight:lighter; color:#777; font-size:0.9em; font-family:acta-display; display:block; float:left">TAGS: 
            <%= f.text_field :tag_list %></span>
			          <div style="float:right" class="actions" >
			          <span style="margin-right:6em"><%= f.submit "Publicar", id: "button_send", class: "button-nopost", style:"margin-top:12%", :disabled => true %></span>
			      </div>
			    <br/>
			    <p id="wait" style="color:red; margin-top:6%">Vista Previa <i>(edita el contenido dando click sobre el texto)</i></p>

			  <% end %>
			<% end %>
		</div>
	</div>
</div>
<script type="text/javascript" charset="UTF-8">
  $(function() {
    $('#status').preview({key:'7f6cf7cec28511e0866c4040d3dc5c07'});

    $('#status').live('keyup keydown', function(e) {
      var empty = $(this).val().length;
      if ( empty > 0 ){
        $('#wait').show();
        $('#micropost-tags').show();
		    $('#button_send').removeClass('button-nopost').addClass('button-want');
		    $('#button_send').removeAttr('disabled');
	    }else{
		    $('#button_send').removeClass('button-want').addClass('button-nopost');
		    $('#button_send').attr("disabled", "disabled");
        $('#micropost-tags').hide();
        $('#wait').hide();
  	  }
    });
  });

  $(function(){
    $('#micropost_title').live('keyup keydown', function(e) {
      var empty = $(this).val().length;
        if ( empty > 0 ){
          $('#button_send').removeAttr('disabled');
          $('#button_send').removeClass('button-nopost').addClass('button-want');
        }else{
          $('#button_send').removeClass('button-want').addClass('button-nopost');
          $('#button_send').attr("disabled", "disabled");
        }
    });
  });

  $(function(){
    $('#select_file').live('click', function(){
      $('#file_for_picture').show();
      $('#status').hide();
      $('#selection_file').hide();
      $('#selection_url').show();
      $('#label_picture').show();
      $('#label_url').hide();
      $('#post_title').show();
      $('#wait').hide();
      $('div.selector.small').hide();
    });
  });

  $(function(){
    $('#selection_url').live('click', function(){
      $('#file_for_picture').hide();
      $('#status').show();
      $('#selection_file').show();
      $('#selection_url').hide();
      $('#label_picture').hide();
      $('#label_url').show();
      $('#post_title').hide();
    });
  });
			
  $(function() {
    $('input#button_send').click(function(){
      var url = $('input#id_url:hidden').val();
      $('input#micropost_url').val(url);
       var provider_url = $('input#id_provider_url:hidden').val();
       $('input#micropost_provider').val(provider_url);
        var title = $('input#id_title:hidden').val() || $('#micropost_title').val();
        $('input#micropost_title').val(title);
         var description = $('input#id_description:hidden').val();
         $('input#micropost_description').val(description);
          var image = $('input#id_thumbnail_url:hidden').val();
          $('input#micropost_thumbnail').val(image);
    });
    return false;
  });

  $(function() {
    $('input#button_send').click(function(){
      setTimeout(function() {
               location.reload('.microposts');
      }, 500);
    });
  });


Galleria.run('.galleria');

</script>