<div class="modal-story">
	<div style="max-height:330px; box-shadow: #555 0px 0px 0 8px; opacity:1" class="modal-body">
    <span style="cursor:pointer" class="close-button" data-dismiss="modal" aria-hidden="true">x</span>
    <p style="font-weight:lighter; color:#555; font-size:2.2em; font-family:acta-display; text-align:center">Comparte una historia</p>
    <br />
    <div class="bs-docs-example">
        <div class="tabbable" style="margin-bottom: 0px;">
          <ul class="nav nav-tabs">
            <% if current_user.roles.first.name == "admin" %>
              <li style="margin-left:5%;" class="active">
                <span id="select_url" style="cursor:pointer; color: rgb(0, 165, 240);">
                  <div style="text-align: center; border: 1px solid #999;" class="span3">
                    <%= image_tag('link_blanco.png', style: "width:30px; background-color:black; margin-top:6px") %><br/><br />
                      <span id="link_name" style="color:#777; font-weight:lighter; font-size:1.2em">Ingresa un Link</span>
                  </div>
                </span>
              </li>
              <li style="">
                <span id="select_img" style="text-align: center; cursor:pointer; color: rgb(0, 165, 240);">
                  <div style="margin-top:-4px; text-align: center;" class="span3">
                    <%= image_tag('iconmonstr-photo-camera-6-icon.png', style: "width:40px") %> <br/><br />
                      <span id="img_name" style="color:#777; font-weight:lighter; font-size:1.2em">Sube una imagen</span>
                  </div>
                </span>
              </li>
            <% end %>
          </ul>
        </div>
    </div>
    <div class="span7">
    	<%= form_for(@micropost) do |f| %>
			    <%= f.hidden_field :url, :value => "http://soxialit.com" %>
          <h3 id="label_url"></h3>
          <%= f.text_area :url, :rows => "1", :class => "span5", :id => "status", :placeholder => 'http://' %>
          <h3 id="label_img" style="display:none;"></h3>
          <%= f.file_field :picture, :rows => "1", :class => "span4", id: "selection_file", style: "display:none" %>
          <div style="float:right; margin-right: 5%"class="actions" >
            <span><%= f.submit "Compartir", id: "publicar", class: "button-nopost", :disabled => true, style:"margin-top:-2%;" %></span>
          </div>
          <div id="url_val" style="display:none; color:red">Introduce una URL valida</div>
      <% end %>
	</div>
</div>

<script type="text/javascript">
    $(function(){
        $('#select_img').live('click', function(){
            $('#label_img').show();
            $('#selection_file').show();
            $('#label_url').hide();
            $('#status').hide();
            $('#select_url').find('.span3').css('border', 'none');
            $(this).find('.span3').css('border', '1px solid #999');
            $('#status').val('http://soxialit.com');
        });


        $('#select_url').live('click', function(){
            $('#label_img').hide();
            $('#selection_file').hide();
            $('#label_url').show();
            $('#status').show();
            $(this).find('.span3').css('border', '1px solid #999');
            $('#select_img').find('.span3').css('border', 'none');
            $('#status').val('');
        });


        $('#status').live('keyup keydown', function(){
          var url = $(this).val();
          console.log(url);
           var urlregex = new RegExp("^(http|https|ftp)\://([a-zA-Z0-9\.\-]+(\:[a-zA-Z0-9\.&amp;%\$\-]+)*@)*((25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9])\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])|([a-zA-Z0-9\-]+\.)*[a-zA-Z0-9\-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(\:[0-9]+)*(/($|[a-zA-Z0-9\.\,\?\'\\\+&amp;%\$#\=~_\-]+))*$");
          if (urlregex.test(url)) {
            console.log('ok');
            $('#publicar').removeAttr('disabled');
            $('#publicar').removeClass('button-nopost').addClass('button-story');
            $('#url_val').hide();
          }else{
            console.log('nook');
            $('#publicar').removeClass('button-story').addClass('button-nopost');
            $('#publicar').attr("disabled", "disabled");
            $('#url_val').show();
          }
        });

    });
</script>
